function plusSlides(n){showSlides(slideIndex+=n)}function currentSlide(n){showSlides(slideIndex=n)}function showSlides(n){var t,i=document.getElementsByClassName("dot");for(n>slides.length&&(slideIndex=1),n<1&&(slideIndex=slides.length),t=0;t<slides.length;t++)slides[t].style.display="none";for(t=0;t<i.length;t++)i[t].className=i[t].className.replace(" active","");slides[slideIndex-1].style.display="block";i[slideIndex-1].className+=" active"}function popupOpen(n){if(n&&unlock){const t=document.querySelector(".popup.open-popup");t?popupClose(t,!1):bodyLock();n.addClass("open-popup");n.bind("click",function(n){n.target.closest(".popup-content")||popupClose(n.target.closest(".popup"))})}}function popupClose(n=true){if(unlock){const t=document.querySelector(".popup.open-popup");t.classList.remove("open-popup");n&&bodyUnLock()}}function bodyLock(){const n=window.innerWidth-document.querySelector(".wrapper").offsetWidth+"px";if(lockPadding.length>0)for(let t=0;t<lockPadding.length;t++){const i=lockPadding[t];i.style.paddingRight=n}body.style.paddingRight=n;body.classList.add("lock");unlock=!1;setTimeout(function(){unlock=!0},timeout)}function bodyUnLock(){setTimeout(function(){if(lockPadding.length>0)for(let n=0;n<lockPadding.length;n++){const t=lockPadding[n];t.style.paddingRight="0px"}body.style.paddingRight="0px";body.classList.remove("lock")},timeout);unlock=!1;setTimeout(function(){unlock=!0},timeout)}function renderChartBar(n,t,i,r){const u={labels:t.answers.map(n=>n.title),datasets:[{label:" Количество",data:t.answers.map(n=>n.value),backgroundColor:["#EC1C24",]},]},f={plugins:{legend:{display:!1,labels:{color:"rgb(255, 99, 132)"}},title:{display:!0,text:"Вопрос "+ ++r+"/"+countBarCharts,padding:{top:30,bottom:5},position:"top",align:"start",font:{family:"Montserrat",size:20,weight:"bold"},color:"#0F2232"},subtitle:{display:!0,text:t.title,padding:{top:0,bottom:20},position:"top",align:"start",font:{family:"Montserrat",size:16,weight:"bold"},color:"#0F2232"}},scales:{y:{ticks:{stepSize:1}}}};return i!=null&&i.destroy(),new Chart(n,{type:"bar",data:u,options:f})}function addAnswer(n){const t=$("[id*="+n+numberAnswer+"]").length,i=n+numberAnswer+t,r=n+titleAnswer+t,u=n+signatureMediaAnswer+t,f=n+typeMediaAnswer+t,e=n+linkMediaAnswer+t,o=n+isActiveAnswer+t;var s=`<div class="create-survey__body-body-item">
                    <div class="create-survey__body-body-item-body">
                        <div class="create-survey__body-body-item-body-answer">
                            <span id="${i}">${t+1}</span>
                            <input id="${r}" name="Questions[${n}].Answers[${t}].Title" type="text" placeholder="Введите текст ответа">
                        </div>
                        <div class="create-survey__body-body-item-body-link">
                            <input id="${u}" name="Questions[${n}].Answers[${t}].Media.Signature" type="text" placeholder="Подпись мультимедия">
                            <select id="${f}" name="Questions[${n}].Answers[${t}].Media.SelectedType.Value">
                                <option value="1">Картинка</option>
                                <option value="2">Видео</option>
                            </select>
                            <input id="${e}" name="Questions[${n}].Answers[${t}].Media.Link" type="text" placeholder="Вставьте ссылку">
                            <div class="create-survey__body-body-item-body-checkbox">
                                <label>Использовать?</label>
                                <input id="${o}" name="Questions[${n}].Answers[${t}].IsActive" type="checkbox" value="true">
                            </div>
                        </div>
                    </div>
                </div>`;$("#"+answerList+n).append(s)}function addMedia(n){const t=$("[id*="+n+numberMedia+"]").length,i=n+numberMedia+t,r=n+signatureMedia+t,u=n+typeMedia+t,f=n+linkMedia+t;var e=`<div id="${i}" class="create-survey__body-header-item">
                    <input id="${r}" name="Questions[${n}].Medias[${t}].Signature" type="text" placeholder="Подпись мультимедия">
                    <select id="${u}" name="Questions[${n}].Medias[${t}].SelectedType.Value">
                        <option value="1">Картинка</option>
                        <option value="2">Видео</option>                    
                    </select>
                    <input id="${f}" name="Questions[${n}].Medias[${t}].Link" type="text" placeholder="Вставьте ссылку">
                    <button><img src="../img/ilusha.svg" alt=""></button>
                </div>`;$("#"+mediaList+n).append(e)}var slideIndex=1,pieChart,countBarCharts,barCharts;$(".dot").on("click",function(){const n=this.id.replace("picture_","");currentSlide(n)});$(".prev").on("click",function(){plusSlides(-1)});$(".next").on("click",function(){plusSlides(1)});const slides=document.getElementsByClassName("mySlides");const surveyList=document.querySelector("#survey-list");$("input[name=isActive]").change(function(){$.ajax({type:"GET",url:"/Survey/GetSurveyListPartial",data:{isActive:$("input[name=isActive]:checked").val(),stringSearch:$("#search").val()},success:function(n){surveyList.innerHTML=n}})});$("#search").bind("input",function(){$.ajax({type:"GET",url:"/Survey/GetSurveyListPartial",data:{isActive:$("input[name=isActive]:checked").val(),stringSearch:$("#search").val()},success:function(n){console.log(n);surveyList.innerHTML=n}})});$(document).ready(function(){function t(){const n=Array.from(document.querySelectorAll(".radio-button__input")).map(n=>n.checked);$.ajax({type:"GET",url:"/Survey/Save",traditional:!0,data:{answers:n},success:function(n){window.location.replace(n)}});event.preventDefault()}function n(r){const u=Array.from(document.querySelectorAll(".radio-button__input")).map(n=>n.checked);console.log(u);$.ajax({type:"GET",url:"/Survey/GetQuestion",traditional:!0,data:{isNext:r,answers:u},success:function(r){$(".question").html(r);$("#button_rigth").on("click",function(){n(!0)});$("#button_left").on("click",function(){n(!1)});$("#button_end").on("click",function(){i()});$(".dot").on("click",function(){const n=this.id.replace("picture_","");currentSlide(n)});$(".prev").on("click",function(){plusSlides(-1)});$(".next").on("click",function(){plusSlides(1)});$("#button_save").on("click",function(){t()})}});event.preventDefault()}function i(){$.ajax({type:"POST",url:"/Survey/Survey",traditional:!0,data:{test:"dsad"},success:function(n){$(".question").html(n)}})}$("#button_rigth").on("click",function(){n(!0)});$("#button_left").on("click",function(){n(!1)});$("#button_save").on("click",function(){t()})});const lockPadding=document.querySelectorAll(".lock-padding"),body=document.querySelector("body");let unlock=!0;const timeout=800;document.addEventListener("keydown",function(n){if(n.which===27){const n=document.querySelector(".popup.open-popup");popupClose(n)}});const usersList=document.querySelector("#users-id");$("#search-users").bind("input",function(){$.ajax({type:"GET",url:"/Admin/GetUsersBySearchString",data:{searchString:$("#search-users").val()},success:function(n){console.log(n);usersList.innerHTML=n}})});showInPopup=n=>{$.ajax({type:"GET",url:n,success:function(n){$(".popup-body .popup-content").html(n);popupOpen($(".popup"));$(document).ready(function(n){n("#user-number").mask("+7(999) 999-9999")})}})};jQueryAjaxPost=n=>($.ajax({type:"POST",url:"/Admin/UserEditPartial/",data:new FormData(n),dataType:"json",contentType:!1,processData:!1,success:function(n){n.isValid&&($("#users-id").html(n.html),$(".popup-body .popup-content").html(""),popupClose())},error:function(n){$(".popup-body .popup-content").html(n.responseText);$(document).ready(function(n){n("#user-number").mask("+7(999) 999-9999")})}}),!1);jQueryAjaxPostCreate=n=>($.ajax({type:"POST",url:"/Admin/UserCreatePartial/",data:new FormData(n),dataType:"json",contentType:!1,processData:!1,success:function(n){n.isValid&&($("#users-id").html(n.html),$(".popup-body .popup-content").html(""),popupClose())},error:function(n){$(".popup-body .popup-content").html(n.responseText);$(document).ready(function(n){n("#user-number").mask("+7(999) 999-9999")})}}),!1);jQueryAjaxDelete=n=>{if(confirm("Вы действительно хотите удалить?"))try{$.ajax({type:"POST",url:"/Admin/UserDelete/",data:{userName:n},success:function(n){$("#users-id").html(n.html)},error:function(n){console.log(n)}})}catch(t){console.log(t)}return!1};countBarCharts=0;barCharts=[];$(document).ready(function(){function n(){const n=document.querySelector(".result__fillter").id,i=$("#combobox").val();t&&$.ajax({type:"GET",url:"/Survey/GetResult",traditional:!0,data:{id:n,fillter:i},success:function(n){var i,f,u,r,t;console.log(n);const e={labels:n.surveyedUsers.map(n=>n.title),datasets:[{label:" Количество",data:n.surveyedUsers.map(n=>n.value),backgroundColor:["rgb(237, 28, 36)","rgb(247, 158, 164)",],hoverOffset:20,borderColor:"#E9ECEE",borderWidth:5,hoverBorderColor:"#E9ECEE"},]},o={plugins:{datalabels:{formatter:(n,t)=>{let i=0,u=t.chart.data.datasets[0].data;u.map(n=>{i+=n});let r=(n*100/i).toFixed(1)+"%";return r=="0.0%"?"":r},color:"#fff",font:{family:"Montserrat",size:18,weight:"bold"}},title:{display:!1},legend:{position:"left"}}},s=document.getElementById("myChart1");if(pieChart!=null&&pieChart.destroy(),pieChart=new Chart(s,{type:"pie",data:e,plugins:[ChartDataLabels],options:o}),i=document.querySelectorAll(".barChart-item"),f=i.length==0,f){for(console.log(n.questionResultDatas),u=0;u<n.questionResultDatas.length;u++)countBarCharts++,r=document.createElement("canvas"),r.id="barChart"+countBarCharts,r.classList+="barChart-item",document.getElementById("barCharts").appendChild(r);barCharts=new Array(countBarCharts);i=document.querySelectorAll(".barChart-item")}t=0;i.forEach(i=>{console.log("arr",barCharts),barCharts[t]=renderChartBar(i,n.questionResultDatas[t],barCharts[t],t),t++})}})}const t=document.getElementById("myChart1");n();$(document).on("change","select",function(){$("option[value="+this.value+"]",this).attr("selected",!0).siblings().removeAttr("selected")});$("#button-apply").on("click",function(){n()})});const buttonAddMedia="addMedia_",buttonAddAnswer="addAnswer_",mediaList="mediaList_",answerList="answerList_",numberQuestion="number_q_",numberAnswer="_number_a_",numberMedia="_number_m_",signatureMediaAnswer="_signature_a_m_",signatureMedia="_signature_m_",titleAnswer="_title_a_",titleQuestion="title_q_",typeMediaAnswer="_type_a_m_",typeMedia="_type_m_",linkMediaAnswer="_link_a_m_",linkMedia="_link_m_",isActiveAnswer="_active_a_";$("#addQuestion").click(function(){const n=$("[id^=q_]").length,t=buttonAddMedia+n,i=buttonAddAnswer+n,r=mediaList+n,u=answerList+n,f=numberQuestion+n,e=titleQuestion+n;var o=`<div class="create-survey__item" id="q_${n}">
                    <div class="create-survey__item-header-div">
                        <div class=""></div>
                        <div class="create-survey__header">
                            <button><img src="../img/strelka_left.svg" alt=""></button>
                            <span id="${f}">Вопрос ${n+1}</span>
                            <button><img src="../img/strelka_right.svg" alt=""></button>
                        </div>
                    </div>
                    <div class="create-survey__body">
                        <div class="create-survey__body-header">
                            <div class="create-survey__body-header-title">
                                <span class="create-survey__body-title3">Текст вопроса</span>
                                <input id="${e}" name="Questions[${n}].Title" type="text" placeholder="Введите текст вопроса">
                            </div>
                            <div class="create-survey__body-header-download" id="addMedia">
                                <button id="${t}">Добавить мультимедия</button>
                            </div>
                            <div class="create-survey__body-header-list" id="${r}">

                            </div>
                        </div>
                        <div class="create-survey__body-body">
                            <div class="create-survey__body-header-title">
                                <span class="create-survey__body-title3">Варианты ответов</span>
                            </div>
                            <div class="create-survey__body-header-download create-survey__body-header-add-answer">
                                <button id="${i}">Добавить ответ</button>
                            </div>
                            <div class="create-survey__body-header-item-title">
                                <span>№</span>
                                <span>Текст варианта ответа</span>
                            </div>
                            <div class="create-survey__body-body-list" id="${u}">

                            </div>
                        </div>
                    </div>
                </div>`;return $("#questionList").append(o),$("#"+i).click(function(n){const t=n.target.id.replace(buttonAddAnswer,"");return addAnswer(t),!1}),$("#"+t).click(function(n){const t=n.target.id.replace(buttonAddMedia,"");return addMedia(t),!1}),!1});$("#addQuestion").click();